const t=new class{constructor(t=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]]){this.initialState=t,this.state=t.map(t=>[...t]),this.score=0,this.status="idle"}start(){this.score=0,this.status="playing",this.fillOutRandomCell(this.generateNumber()),this.fillOutRandomCell(this.generateNumber())}restart(){this.state=this.initialState.map(t=>[...t]),this.score=0,this.status="idle"}filterZero(t){return t.filter(t=>0!==t)}slide(t){let e=this.filterZero(t);for(let t=0;t<e.length-1;t++)e[t]===e[t+1]&&(e[t]*=2,e[t+1]=0,this.score+=e[t]);for(e=this.filterZero(e);e.length<4;)e.push(0);return e}moveLeft(){if("playing"===this.status)for(let t=0;t<4;t++){let e=this.state[t];e=this.slide(e),this.state[t]=e}}moveRight(){if("playing"===this.status)for(let t=0;t<4;t++){let e=this.state[t];e.reverse(),(e=this.slide(e)).reverse(),this.state[t]=e}}moveUp(){if("playing"===this.status)for(let t=0;t<4;t++){let e=[];for(let s=0;s<4;s++)e.push(this.state[s][t]);e=this.slide(e);for(let s=0;s<4;s++)this.state[s][t]=e[s]}}moveDown(){if("playing"===this.status)for(let t=0;t<4;t++){let e=[];for(let s=0;s<4;s++)e.push(this.state[s][t]);e.reverse(),(e=this.slide(e)).reverse();for(let s=0;s<4;s++)this.state[s][t]=e[s]}}getScore(){return this.score}getState(){return this.state}getStatus(){return this.status}generateNumber(){return Math.random()>=.9?4:2}getCellValue(){return Math.floor(16*Math.random())}fillOutRandomCell(t){let e=this.getEmptyCells();if(e.length>0){let s=Math.floor(Math.random()*e.length),r=e[s];this.state[Math.floor(r/4)][r%4]=t,e=this.getEmptyCells()}0!==e.length||this.isMovePossible()||(this.status="lose")}getEmptyCells(){let t=[],e=this.getState().flat();for(let s=0;s<e.length;s++)0===e[s]&&t.push(s);return t}updateStatus(){this.state.filter(t=>2048===t).length>=1&&(this.status="win")}isMovePossible(){let t=!1;for(let e=0;e<4;e++)for(let s=0;s<3;s++)this.state[e][s]===this.state[e][s+1]&&(t=!0),this.state[s][e]===this.state[s+1][e]&&(t=!0);return t}},e=document.querySelector(".button"),s=document.querySelector(".game-field");function r(e){let s=t.getState().map(t=>[...t]);switch(e.key){case"ArrowUp":t.moveUp();break;case"ArrowDown":t.moveDown();break;case"ArrowLeft":t.moveLeft();break;case"ArrowRight":t.moveRight()}s.toString()!==t.getState().toString()&&(t.fillOutRandomCell(t.generateNumber()),i())}function i(){let e=t.getStatus(),i=t.getState(),a=t.getScore();document.querySelector(".game-score").innerHTML=a;for(let t=0;t<4;t++)for(let e=0;e<4;e++){let r=i[t][e],a=s.rows[t].cells[e];a.innerHTML=r||"",a.classList="field-cell",r&&a.classList.add(`field-cell--${r}`)}t.updateStatus(),("lose"===e||"win"===e)&&(document.querySelector(`.message-${e}`).classList.remove("hidden"),document.removeEventListener("keydown",r))}i(),e.addEventListener("click",s=>{s.target.classList.contains("start")?t.start():s.target.classList.contains("restart")&&t.restart(),function(){switch(document.querySelector(".game-score").innerHTML=0,t.getStatus()){case"idle":e.classList.remove("restart"),e.classList.add("start"),e.innerHTML="Start",document.removeEventListener("keydown",r);break;case"playing":e.classList.remove("start"),e.classList.add("restart"),e.innerHTML="Restart",document.addEventListener("keydown",r)}document.querySelectorAll(".message").forEach(t=>t.classList.add("hidden"))}(),i(t.getState())});
//# sourceMappingURL=index.b1f9c11e.js.map
