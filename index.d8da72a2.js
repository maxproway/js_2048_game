!function(){function t(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function e(e){return function(e){if(Array.isArray(e))return t(e)}(e)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(e)||function(e,r){if(e){if("string"==typeof e)return t(e,void 0);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return t(e,void 0)}}(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var r=new(function(){var t;function r(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]];!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,r),this.initialState=t,this.state=t.map(function(t){return e(t)}),this.score=0,this.status="idle"}return t=[{key:"start",value:function(){this.score=0,this.status="playing",this.fillOutRandomCell(this.generateNumber()),this.fillOutRandomCell(this.generateNumber())}},{key:"restart",value:function(){this.state=this.initialState.map(function(t){return e(t)}),this.score=0,this.status="idle"}},{key:"filterZero",value:function(t){return t.filter(function(t){return 0!==t})}},{key:"slide",value:function(t){for(var e=this.filterZero(t),r=0;r<e.length-1;r++)e[r]===e[r+1]&&(e[r]*=2,e[r+1]=0,this.score+=e[r]);for(e=this.filterZero(e);e.length<4;)e.push(0);return e}},{key:"moveLeft",value:function(){if("playing"===this.status)for(var t=0;t<4;t++){var e=this.state[t];e=this.slide(e),this.state[t]=e}}},{key:"moveRight",value:function(){if("playing"===this.status)for(var t=0;t<4;t++){var e=this.state[t];e.reverse(),(e=this.slide(e)).reverse(),this.state[t]=e}}},{key:"moveUp",value:function(){if("playing"===this.status)for(var t=0;t<4;t++){for(var e=[],r=0;r<4;r++)e.push(this.state[r][t]);e=this.slide(e);for(var n=0;n<4;n++)this.state[n][t]=e[n]}}},{key:"moveDown",value:function(){if("playing"===this.status)for(var t=0;t<4;t++){for(var e=[],r=0;r<4;r++)e.push(this.state[r][t]);e.reverse(),(e=this.slide(e)).reverse();for(var n=0;n<4;n++)this.state[n][t]=e[n]}}},{key:"getScore",value:function(){return this.score}},{key:"getState",value:function(){return this.state}},{key:"getStatus",value:function(){return this.status}},{key:"generateNumber",value:function(){return Math.random()>=.9?4:2}},{key:"getCellValue",value:function(){return Math.floor(16*Math.random())}},{key:"fillOutRandomCell",value:function(t){var e=this.getEmptyCells();if(e.length>0){var r=Math.floor(Math.random()*e.length),n=e[r];this.state[Math.floor(n/4)][n%4]=t,e=this.getEmptyCells()}0!==e.length||this.isMovePossible()||(this.status="lose")}},{key:"getEmptyCells",value:function(){for(var t=[],e=this.getState().flat(),r=0;r<e.length;r++)0===e[r]&&t.push(r);return t}},{key:"updateStatus",value:function(){this.state.filter(function(t){return 2048===t}).length>=1&&(this.status="win")}},{key:"isMovePossible",value:function(){for(var t=!1,e=0;e<4;e++)for(var r=0;r<3;r++)this.state[e][r]===this.state[e][r+1]&&(t=!0),this.state[r][e]===this.state[r+1][e]&&(t=!0);return t}}],function(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}(r.prototype,t),r}()),n=document.querySelector(".button"),a=document.querySelector(".game-field");function s(t){var n=r.getState().map(function(t){return e(t)});switch(t.key){case"ArrowUp":r.moveUp();break;case"ArrowDown":r.moveDown();break;case"ArrowLeft":r.moveLeft();break;case"ArrowRight":r.moveRight()}n.toString()!==r.getState().toString()&&(r.fillOutRandomCell(r.generateNumber()),i())}function i(){var t=r.getStatus(),e=r.getState(),n=r.getScore();document.querySelector(".game-score").innerHTML=n;for(var i=0;i<4;i++)for(var o=0;o<4;o++){var u=e[i][o],l=a.rows[i].cells[o];l.innerHTML=u||"",l.classList="field-cell",u&&l.classList.add("field-cell--".concat(u))}r.updateStatus(),("lose"===t||"win"===t)&&(document.querySelector(".message-".concat(t)).classList.remove("hidden"),document.removeEventListener("keydown",s))}i(),n.addEventListener("click",function(t){t.target.classList.contains("start")?r.start():t.target.classList.contains("restart")&&r.restart(),function(){switch(document.querySelector(".game-score").innerHTML=0,r.getStatus()){case"idle":n.classList.remove("restart"),n.classList.add("start"),n.innerHTML="Start",document.removeEventListener("keydown",s);break;case"playing":n.classList.remove("start"),n.classList.add("restart"),n.innerHTML="Restart",document.addEventListener("keydown",s)}document.querySelectorAll(".message").forEach(function(t){return t.classList.add("hidden")})}(),i(r.getState())})}();
//# sourceMappingURL=index.d8da72a2.js.map
